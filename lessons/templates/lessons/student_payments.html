{% extends "lessons/base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h2>Record Student Payments</h2>

    <!-- Class selection filter -->
    <form method="get" class="mb-3">
        <label for="class_group">Select Class:</label>
        <select name="class_group" id="class_group" onchange="this.form.submit()">
            <option value="">--Choose--</option>
            {% for cls in class_groups %}
                <option value="{{ cls.id }}" {% if selected_class_id == cls.id|stringformat:"s" %}selected{% endif %}>{{ cls.name }}</option>
            {% endfor %}
        </select>
    </form>

    {% if students %}
    <form method="post">
        {% csrf_token %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Student</th>
                    <th>Amount Paid (Ksh)</th>
                    <th>Balance (Ksh)</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                <tr>
                    <td>{{ student.first_name }} {{ student.last_name }}</td>
                    <td>
                        <input type="number" name="amount_{{ student.id }}" min="0" step="0.01" class="form-control">
                    </td>
                    <td>{{ student.balance|floatformat:2 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="submit" class="btn btn-primary">Save Payments</button>
    </form>
    {% else %}
        <p>Please select a class to see students.</p>
    {% endif %}
</div>
{% endblock %}
